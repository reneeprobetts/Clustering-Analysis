> medicare <- read_delim("Desktop/classes/ie 304/medicare.txt", +     "\t", escape_double = FALSE, trim_ws = TRUE)Parsed with column specification:cols(  .default = col_integer(),  nppes_provider_last_org_name = col_character(),  nppes_provider_first_name = col_character(),  nppes_provider_mi = col_character(),  nppes_credentials = col_character(),  nppes_provider_gender = col_character(),  nppes_entity_code = col_character(),  nppes_provider_street1 = col_character(),  nppes_provider_street2 = col_character(),  nppes_provider_city = col_character(),  nppes_provider_zip = col_character(),  nppes_provider_state = col_character(),  nppes_provider_country = col_character(),  provider_type = col_character(),  medicare_participation_indicator = col_character(),  total_services = col_double(),  total_submitted_chrg_amt = col_double(),  total_medicare_allowed_amt = col_double(),  total_medicare_payment_amt = col_double(),  total_medicare_stnd_amt = col_double(),  drug_suppress_indicator = col_character()  # ... with 12 more columns)See spec(...) for full column specifications.|=======================================| 100%  286 MB> View(medicare)> beneficiaries1 <- select(medicare, starts_with("beneficiary_cc"),total_medicare_payment_amt, total_med_medicare_payment_amt,total_drug_medicare_payment_amt, beneficiary_average_age, beneficiary_female_count, beneficiary_male_count,total_services, total_unique_benes)Error in select(medicare, starts_with("beneficiary_cc"), total_medicare_payment_amt,  :   could not find function "select"> library("dplyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")Attaching package: ÔdplyrÕThe following objects are masked from Ôpackage:statsÕ:    filter, lagThe following objects are masked from Ôpackage:baseÕ:    intersect, setdiff, setequal, union> library("cluster", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")> beneficiaries1 <- select(medicare, starts_with("beneficiary_cc"),total_medicare_payment_amt, total_med_medicare_payment_amt,total_drug_medicare_payment_amt, beneficiary_average_age, beneficiary_female_count, beneficiary_male_count,total_services, total_unique_benes)> beneficiaries_sample <- beneficiaries1[sample(nrow(beneficiaries1), 100000), ]> wss <- (nrow(beneficiaries_sample)-1)*sum(apply(beneficiaries_sample,2,var))> for (i in 2:20) {wss[i] <- kmeans(na.omit(beneficiaries_sample), centers = i, nstart = 20)$tot.withinss+ }There were 50 or more warnings (use warnings() to see the first 50)> plot(1:20,wss, type = 'b', main = 'Sample 1', xlab="Number of Clusters", ylab="Within Groups Sum of Squares")> ### create new sample and determine best clusters > beneficiaries_sample2 <- beneficiaries[sample(nrow(beneficiaries), 100000), ]Error: object 'beneficiaries' not found> ### create new sample and determine best clusters > beneficiaries_sample2 <- beneficiaries1[sample(nrow(beneficiaries1), 100000), ]> wss2 <- (nrow(beneficiaries_sample2)-1)*sum(apply(beneficiaries_sample2,2,var))> for (i in 2:20) {wss2[i] <- kmeans(na.omit(beneficiaries_sample2), centers = i, nstart = 20)$tot.withinss+ }There were 50 or more warnings (use warnings() to see the first 50)> plot(1:20,wss2, type = 'b', main = "Sample 2", xlab="Number of Clusters", ylab="Within Groups Sum of Squares")> ## create new sample and determine best clusters > beneficiaries_sample3 <- beneficiaries1[sample(nrow(beneficiaries1), 100000), ]> wss3 <- (nrow(beneficiaries_sample3)-1)*sum(apply(beneficiaries_sample3,2,var))> for (i in 2:20) {wss3[i] <- kmeans(na.omit(beneficiaries_sample3), centers = i, nstart = 20)$tot.withinss+ }There were 50 or more warnings (use warnings() to see the first 50)> plot(1:20,wss3, type = 'b', main ="Sample 3", xlab="Number of Clusters", ylab="Within Groups Sum of Squares")> ## create new sample and determine best clusters > beneficiaries_sample4 <- beneficiaries1[sample(nrow(beneficiaries1), 100000), ]> wss4 <- (nrow(beneficiaries_sample4)-1)*sum(apply(beneficiaries_sample4,2,var))> for (i in 2:20) {wss4[i] <- kmeans(na.omit(beneficiaries_sample4), centers = i, nstart = 20)$tot.withinss+ }There were 50 or more warnings (use warnings() to see the first 50)> plot(1:20,wss4, type = 'b', main ="Sample 4", xlab="Number of Clusters", ylab="Within Groups Sum of Squares")> ## create new sample and determine best clusters > beneficiaries_sample5 <- beneficiaries1[sample(nrow(beneficiaries1), 100000), ]> wss5 <- (nrow(beneficiaries_sample5)-1)*sum(apply(beneficiaries_sample5,2,var))> for (i in 2:20) {wss5[i] <- kmeans(na.omit(beneficiaries_sample5), centers = i, nstart = 20)$tot.withinss+ }There were 50 or more warnings (use warnings() to see the first 50)> plot(1:20,wss5, type = 'b', main ="Sample 5", xlab="Number of Clusters", ylab="Within Groups Sum of Squares")> ## create new sample and determine best clusters > beneficiaries_sample6 <- beneficiaries1[sample(nrow(beneficiaries1), 100000), ]> wss6 <- (nrow(beneficiaries_sample6)-1)*sum(apply(beneficiaries_sample6,2,var))> for (i in 2:20) {wss6[i] <- kmeans(na.omit(beneficiaries_sample6), centers = i, nstart = 20)$tot.withinss+ }There were 50 or more warnings (use warnings() to see the first 50)> plot(1:20,wss6, type = 'b', main ="Sample 6", xlab="Number of Clusters", ylab="Within Groups Sum of Squares")> km.out1 <- kmeans(na.omit(beneficiaries1),10,nstart = 10)> km.out1$tot.withinss[1] 2.557579e+16> plot(beneficiaries1$beneficiary_cc_afib_percent,beneficiaries1$total_medicare_payment_amt,col=km.out1$cluster, xlab = 'Chronic Illness Atrial Fibrulation', ylab='Medicare Payment')> plot(beneficiaries1$total_medicare_payment_amt, beneficiaries1$total_services, col=km.out1$cluster)> variance <- matrix(0,1,24)> for (i in 1:24){variance[i]<-var(km.out1$centers[ ,i])}> > write.csv(variance, file = "variance.csv")